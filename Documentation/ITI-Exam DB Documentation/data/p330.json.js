window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p330","name":"generateExam","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"ITI-Exam System DB","id":"d10"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"generateExam"},{"field":"Type","value":"Procedure"}],"script":"CREATE proc generateExam \r\n@crs_name varchar(50), @mcq_no int, @tf_no int, @ex_duration int =2 , @ex_date date =null\r\nas\r\n\tif @ex_date is null set @ex_date =getDate()\r\n\t\r\n\tdeclare @crs_id int\r\n\tset @crs_id = (SELECT crs_id FROM course WHERE course_name = @crs_name)\r\n\t\r\n\tif @crs_id is not null\r\n\tbegin\r\n\t\tINSERT INTO Exam\r\n\t\tVALUES (@ex_duration,@ex_date,@crs_id)\r\n\t\r\n\t\tDECLARE @new_exam_id int = @@IDENTITY\r\n\t\t--select @new_exam_id=max(Exam_id) from Exam\r\n\r\n\t\tDECLARE @total_questions int = @mcq_no + @tf_no \r\n\t\r\n\t\tINSERT INTO Exam_Question\r\n\t\tSELECT TOP (@mcq_no) @new_exam_id, Q_id FROM Question WHERE crs_id = @crs_id and type ='mcq' ORDER BY NEWID()\r\n\t\r\n\t\tInsert Into Exam_Question\r\n\t\tSELECT TOP (@tf_no) @new_exam_id, Q_id FROM Question WHERE crs_id = @crs_id and type = 'tf' ORDER BY NEWID()\r\n\tend\r\n\telse \r\n\tselect 'this course is not found'","parameters":[{"name":"crs_name","description":null,"mode":"IN","data_type":"varchar(50)","custom_fields":{}},{"name":"mcq_no","description":null,"mode":"IN","data_type":"int","custom_fields":{}},{"name":"tf_no","description":null,"mode":"IN","data_type":"int","custom_fields":{}},{"name":"ex_duration","description":null,"mode":"IN","data_type":"int","custom_fields":{}},{"name":"ex_date","description":null,"mode":"IN","data_type":"date","custom_fields":{}}],"dependencies":{"uses":[],"used_by":[]},"imported_at":"2023-01-19 22:19"};